#pragma once
#include "cuda_complex_math.cuh"
#include "cuda_device_variables.cuh"
#include "kernel_coefficients_dormand_prince.cuh"

/**
 * Summation of the k2 array
 *
 */
CUDA_GLOBAL void rungeFuncSumToK2(int i, complex_number* __restrict__ out_Psi_Plus, complex_number* __restrict__ out_Psi_Minus, complex_number* __restrict__ out_n_Plus, complex_number* __restrict__ out_n_Minus, complex_number* __restrict__ in_Psi_Plus, complex_number* __restrict__ in_Psi_Minus, complex_number* __restrict__ in_n_Plus, complex_number* __restrict__ in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus );
/*
 * Summation of the k3 array
 */
CUDA_GLOBAL void rungeFuncSumToK3(int i, complex_number* __restrict__ out_Psi_Plus, complex_number* __restrict__ out_Psi_Minus, complex_number* __restrict__ out_n_Plus, complex_number* __restrict__ out_n_Minus, complex_number* __restrict__ in_Psi_Plus, complex_number* __restrict__ in_Psi_Minus, complex_number* __restrict__ in_n_Plus, complex_number* __restrict__ in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k2_Psi_Plus, complex_number* __restrict__ k2_Psi_Minus, complex_number* __restrict__ k2_n_Plus, complex_number* __restrict__ k2_n_Minus );
/*
 * Summation of the k4 array
 */
CUDA_GLOBAL void rungeFuncSumToK4(int i, complex_number* __restrict__ out_Psi_Plus, complex_number* __restrict__ out_Psi_Minus, complex_number* __restrict__ out_n_Plus, complex_number* __restrict__ out_n_Minus, complex_number* __restrict__ in_Psi_Plus, complex_number* __restrict__ in_Psi_Minus, complex_number* __restrict__ in_n_Plus, complex_number* __restrict__ in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k2_Psi_Plus, complex_number* __restrict__ k2_Psi_Minus, complex_number* __restrict__ k2_n_Plus, complex_number* __restrict__ k2_n_Minus, complex_number* __restrict__ k3_Psi_Plus, complex_number* __restrict__ k3_Psi_Minus, complex_number* __restrict__ k3_n_Plus, complex_number* __restrict__ k3_n_Minus );
/*
 * Summation of the k5 array
 */
CUDA_GLOBAL void rungeFuncSumToK5(int i, complex_number* __restrict__ out_Psi_Plus, complex_number* __restrict__ out_Psi_Minus, complex_number* __restrict__ out_n_Plus, complex_number* __restrict__ out_n_Minus, complex_number* __restrict__ in_Psi_Plus, complex_number* __restrict__ in_Psi_Minus, complex_number* __restrict__ in_n_Plus, complex_number* __restrict__ in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k2_Psi_Plus, complex_number* __restrict__ k2_Psi_Minus, complex_number* __restrict__ k2_n_Plus, complex_number* __restrict__ k2_n_Minus, complex_number* __restrict__ k3_Psi_Plus, complex_number* __restrict__ k3_Psi_Minus, complex_number* __restrict__ k3_n_Plus, complex_number* __restrict__ k3_n_Minus, complex_number* __restrict__ k4_Psi_Plus, complex_number* __restrict__ k4_Psi_Minus, complex_number* __restrict__ k4_n_Plus, complex_number* __restrict__ k4_n_Minus );
/*
 * Summation of the k6 array
 */
CUDA_GLOBAL void rungeFuncSumToK6(int i, complex_number* __restrict__ out_Psi_Plus, complex_number* __restrict__ out_Psi_Minus, complex_number* __restrict__ out_n_Plus, complex_number* __restrict__ out_n_Minus, complex_number* __restrict__ in_Psi_Plus, complex_number* __restrict__ in_Psi_Minus, complex_number* __restrict__ in_n_Plus, complex_number* __restrict__ in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k2_Psi_Plus, complex_number* __restrict__ k2_Psi_Minus, complex_number* __restrict__ k2_n_Plus, complex_number* __restrict__ k2_n_Minus, complex_number* __restrict__ k3_Psi_Plus, complex_number* __restrict__ k3_Psi_Minus, complex_number* __restrict__ k3_n_Plus, complex_number* __restrict__ k3_n_Minus, complex_number* __restrict__ k4_Psi_Plus, complex_number* __restrict__ k4_Psi_Minus, complex_number* __restrict__ k4_n_Plus, complex_number* __restrict__ k4_n_Minus, complex_number* __restrict__ k5_Psi_Plus, complex_number* __restrict__ k5_Psi_Minus, complex_number* __restrict__ k5_n_Plus, complex_number* __restrict__ k5_n_Minus );

/**
 * Final Sum for the next iteration
 */
CUDA_GLOBAL void rungeFuncSumToFinal( int i, complex_number* out_Psi_Plus, complex_number* out_Psi_Minus, complex_number* out_n_Plus, complex_number* out_n_Minus, complex_number* in_Psi_Plus, complex_number* in_Psi_Minus, complex_number* in_n_Plus, complex_number* in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k3_Psi_Plus, complex_number* __restrict__ k3_Psi_Minus, complex_number* __restrict__ k3_n_Plus, complex_number* __restrict__ k3_n_Minus, complex_number* __restrict__ k4_Psi_Plus, complex_number* __restrict__ k4_Psi_Minus, complex_number* __restrict__ k4_n_Plus, complex_number* __restrict__ k4_n_Minus, complex_number* __restrict__ k5_Psi_Plus, complex_number* __restrict__ k5_Psi_Minus, complex_number* __restrict__ k5_n_Plus, complex_number* __restrict__ k5_n_Minus, complex_number* __restrict__ k6_Psi_Plus, complex_number* __restrict__ k6_Psi_Minus, complex_number* __restrict__ k6_n_Plus, complex_number* __restrict__ k6_n_Minus );
/**
 * Calculates the error sum for the RK45 Method
 * The error is calculated as the sum of the absolute values of the k arrays and is not normalized by either the sum of Psi nor the number of cells
 * @param out The output array
 */
CUDA_GLOBAL void rungeFuncFinalError( int i, real_number* out, complex_number* in_Psi_Plus, complex_number* in_Psi_Minus, complex_number* in_n_Plus, complex_number* in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k3_Psi_Plus, complex_number* __restrict__ k3_Psi_Minus, complex_number* __restrict__ k3_n_Plus, complex_number* __restrict__ k3_n_Minus, complex_number* __restrict__ k4_Psi_Plus, complex_number* __restrict__ k4_Psi_Minus, complex_number* __restrict__ k4_n_Plus, complex_number* __restrict__ k4_n_Minus, complex_number* __restrict__ k5_Psi_Plus, complex_number* __restrict__ k5_Psi_Minus, complex_number* __restrict__ k5_n_Plus, complex_number* __restrict__ k5_n_Minus, complex_number* __restrict__ k6_Psi_Plus, complex_number* __restrict__ k6_Psi_Minus, complex_number* __restrict__ k6_n_Plus, complex_number* __restrict__ k6_n_Minus, complex_number* __restrict__ k7_Psi_Plus, complex_number* __restrict__ k7_Psi_Minus, complex_number* __restrict__ k7_n_Plus, complex_number* __restrict__ k7_n_Minus );

/**
 * Summation of the k2,k3 and k4 array
 * This function is used for the RK4
 */
CUDA_GLOBAL void rungeFuncSum( int i, real_number s_dt, complex_number* __restrict__ out_Psi_Plus, complex_number* __restrict__ out_Psi_Minus, complex_number* __restrict__ out_n_Plus, complex_number* __restrict__ out_n_Minus, complex_number* __restrict__ in_Psi_Plus, complex_number* __restrict__ in_Psi_Minus, complex_number* __restrict__ in_n_Plus, complex_number* __restrict__ in_n_Minus, complex_number* __restrict__ k_Psi_Plus, complex_number* __restrict__ k_Psi_Minus, complex_number* __restrict__ k_n_Plus, complex_number* __restrict__ k_n_Minus );
CUDA_GLOBAL void rungeFuncSumToFinalFixed( int i, complex_number* out_Psi_Plus, complex_number* out_Psi_Minus, complex_number* out_n_Plus, complex_number* out_n_Minus, complex_number* in_Psi_Plus, complex_number* in_Psi_Minus, complex_number* in_n_Plus, complex_number* in_n_Minus, complex_number* __restrict__ k1_Psi_Plus, complex_number* __restrict__ k1_Psi_Minus, complex_number* __restrict__ k1_n_Plus, complex_number* __restrict__ k1_n_Minus, complex_number* __restrict__ k2_Psi_Plus, complex_number* __restrict__ k2_Psi_Minus, complex_number* __restrict__ k2_n_Plus, complex_number* __restrict__ k2_n_Minus, complex_number* __restrict__ k3_Psi_Plus, complex_number* __restrict__ k3_Psi_Minus, complex_number* __restrict__ k3_n_Plus, complex_number* __restrict__ k3_n_Minus, complex_number* __restrict__ k4_Psi_Plus, complex_number* __restrict__ k4_Psi_Minus, complex_number* __restrict__ k4_n_Plus, complex_number* __restrict__ k4_n_Minus );